A
A %>% names()
A %>% nest()
yaml_data[[1]]
A %>% nest(variable)
A %>% nest(.key = variable)
A %>% nest(variable)
?nest
A %>% nest(variable)
yaml_data[[1]]
yaml_data[[1]][[1]]
yaml_data[[1]]
View(yaml_data)
nestedlist <- lapply(split(dat, dat$job, drop = TRUE),
function(x) split(x, x[['name']], drop = TRUE))
A
A %>% names()
nestedlist <- lapply(split(A, A$variable, drop = TRUE),
function(x) split(x, x[['name']], drop = TRUE))
A$1
A[1]
A[,1]
A[1,]
A[2,]
yaml_data[[1]]
A[1,]
A[1,] %>% as.list()
A[1,] %>% as.list()[[1]]
A[1,] %>% as.list()
yaml_data[[1]]
A[1,]
yaml_data[[1]][[1]]
?as.list
A[1,] %>% as.list(all.names = T)
A[1,] %>% as.list(all.names = F)
yaml_data[[1]]
yaml_data[[1]][[1]]
A[1,] %>% select(description, unit) %>%
as.list(all.names = F)
A[1,] %>% mutate(tier = 1) %>%
select(description, unit, tier) %>%
as.list(all.names = F)
A[1,] %>% mutate(tier = 1) %>%
select(description, unit, tier) %>%
as.list(all.names = T)
A[1,] %>% mutate(tier = 1) %>%
select(description, unit, tier) %>%
as.list(all.names = T) %>% pluck(1)
yaml_data[[1]][[1]][[1]]
A[1,] %>% mutate(tier = 1) %>%
select(description, unit, tier) %>%
as.list(all.names = T)
A %>% mutate(tier = 1)
A %>% mutate(tier = 1) -> .df
.df[1]%>%
select(description, unit, tier) %>%
as.list(all.names = T)
.df[,1]%>%
select(description, unit, tier) %>%
as.list(all.names = T)
.df[,1]
.df[1,] %>%
select(description, unit, tier) %>%
as.list(all.names = T)
.df %>% slice(1)
.df %>% dplyr::slice(1) %>%
select(description, unit, tier) %>%
as.list(all.names = T)
.df %>% dplyr::slice(1) %>%
select(description, unit, tier) %>%
as.list(all.names = T) %>% as.list()
.df %>% dplyr::slice(1) %>% pull(variable)
.df %>% dplyr::slice(1) %>%
select(description, unit, tier) %>%
as.list(all.names = T) -> B
as.list(variable = B)
list(variable = B)
yaml_data[[1]]
yaml_data[[1]][[1]]
B
.df %>% dplyr::slice(1) %>% pull(variable)
list(`Land Cover` = B)
yaml_data[[1]]
.df %>% dplyr::slice(1) %>%
select(description, unit, tier) %>%
as.list(all.names = T)
.df %>% dplyr::slice(1) %>%
nest()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% as.list
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(.rows))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(data))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(data)) %>% pull(test)
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(unnest(data))) %>% pull()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(unnest(data)))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(data)) %>% pull()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(data, name = variable)) %>% pull()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(data, name = variable))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(data, name = variable)) %>% pull()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% mutate(test = as.list(data, names = variable)) %>% pull()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#nest() %>%
mutate(test = as.list(data, names = variable))
.df %>% dplyr::slice(1) %>% group_by(variable)
mutate(test = as.list(unit)
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
mutate(test = as.list(unit))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
mutate(test = as.list(unit)) %>% pull(test)
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
mutate(test = as.list(unit, variable)) %>% pull(test)
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
mutate(test = as.list(c(unit, variable))) %>% pull(test)
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% pull(data)
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup() %>%
nest()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup() %>%
nest(data = everything())
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup() %>%
nest(data = everything()) %>% as.list
%>%
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  -> B
B$data
B$data %>% as.list()
B$data %>% as.list(all.names = T)
B$data
B$data[[1]] %>% as.list(all.names = T)
B$data
B$data %>% pluck
B$data %>% pluck %>% as.list(all.names = T)
B$data %>% pluck(1) %>% as.list(all.names = T)
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = as.list(data %>% pluck(1), all.names = T))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = as.list(data %>% pluck(1)))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = as.list(data))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = as.list(data %>% pluck(1)))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = as.list(data %>% pluck(1)))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = list(a = as.list(data %>% pluck(1) ) ))
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = list(a = as.list(data %>% pluck(1) ) )) %>% pull(list)
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = list(`Land Cover` = as.list(data %>% pluck(1) ) )) %>% pull(list)
yaml_data[[1]]
.df %>% dplyr::slice(1:2) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = list(`Land Cover` = as.list(data %>% pluck(1) ) )) %>% pull(list)
.df %>% dplyr::slice(1:2)
.df %>% dplyr::slice(1:2) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest()
.df %>% dplyr::slice(1:2) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = list(`Land Cover` = as.list(data %>% pluck(1) ) )) %>% pull(list)
.df %>% dplyr::slice(2) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = list(`Land Cover` = as.list(data %>% pluck(1) ) )) %>% pull(list)
.df %>% dplyr::slice(2) %>% group_by(variable)
.df %>% dplyr::slice(2) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = list(!!variable := = as.list(data %>% pluck(1) ) )) %>% pull(list)
.df %>% dplyr::slice(2) %>% group_by(variable) %>%
#mutate(test = as.list(c(unit, variable))) %>% pull(test)
nest() %>% ungroup()  %>%
mutate(list = list(!!variable := as.list(data %>% pluck(1) ) )) %>% pull(list)
.df %>% dplyr::slice(2) %>% group_by(variable) %>%
nest() %>% ungroup()  %>%
mutate(list = list(!!variable := as.list(data %>% pluck(1) ) )) %>% pull(list)
.df %>% dplyr::slice(2) %>% group_by(variable)
.df %>% dplyr::slice(2) %>% group_by(variable) %>%
nest() %>% ungroup()
.df %>% dplyr::slice(2) %>% group_by(variable) %>%
nest() %>% ungroup()  -> .df1
.df1$variable
.df1 %>%
mutate(list = list(!!.df1$variable := as.list(data %>% pluck(1) ) )) %>% pull(list)
.df1 %>%
mutate(list = list(!!.df1$variable := as.list(data %>% pluck(1) ) ))
.df1 %>%
mutate(list = list(!!"AA":= as.list(data %>% pluck(1) ) )) %>% pull(list)
.df1 %>%
mutate(list = list(get("AA")= as.list(data %>% pluck(1) ) )) %>% pull(list)
.df1
names(.df1$data) <- .df1$variable
names(.df1$data)
.df1 %>%
mutate(list = list(variable = as.list(data %>% pluck(1) ) )) %>% pull(list)
.df1 %>%
mutate(list = list(variable = as.list(data %>% pluck(1) ) ))
.df1
.df %>% dplyr::slice(2) %>% group_by(variable) %>%
nest() %>% ungroup()  -> .df1
.df1
.df1 %>%
mutate(list = list(variable = as.list(data %>% pluck(1) ) ))
names(.df1$list) <- .df1$variable
.df1 %>%
mutate(list = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$list) <- .df2$variable
names(.df2$list)
.df2 %>%  pull(list)
.df %>% dplyr::slice(1) %>% group_by(variable) %>%
nest() %>% ungroup()  -> .df1
.df1 %>%
mutate(list = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$list) <- .df2$variable
.df2 %>%  pull(list)
.df %>% #dplyr::slice(1) %>%
group_by(variable) %>%
nest() %>% ungroup()  -> .df1
.df1 %>%
mutate(list = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$list) <- .df2$variable
.df2 %>%  pull(list)
.df2$variable
names(.df2$list)
.df2
.df %>% #dplyr::slice(1) %>%
group_by(variable) %>%
nest() %>% ungroup()  -> .df1
.df1 %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2 %>% pull(data)
.df
.df %>% #dplyr::slice(1) %>%
select(variable, description, unit, tier) %>%
group_by(variable) %>%
nest() %>% ungroup()  -> .df1
.df %>% #dplyr::slice(1) %>%
select(variable, description, unit, tier) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
yaml_data
.df2
.df2 %>% pull(data)
.df2 %>% pull(data) %>% as.list()
.df %>% dplyr::slice(1) %>%
select(variable, description, unit, tier) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2 %>% pull(data) %>% as.list()
yaml_data[[1]][[1]][[1]]
yaml_data[[1]]
.df2 %>% pull(data)
yaml_data[[2]]
yaml_data
yaml_data %>% names()
.df %>% #dplyr::slice(1) %>%
select(variable, description, unit, tier) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2 %>% pull(data)
.df2
.df2 %>% filter(variable == "Land Cover") %>%  pull(data)
.df2$variable
.df2$data
.df2$data %>% as.list()
.df2$data %>% class
.df2$data
.df2 %>% class
.df2
.df2 %>% spread(variable, data)
.df2 %>% spread(variable, data) %>% as.list
.df2 %>% spread(variable, data) %>% as.list(all.names = F)
yaml_data
.df %>% #dplyr::slice(1) %>%
select(variable, description, unit) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2 %>% spread(variable, data) %>% as.list(all.names = F)
yaml_data %>% names()
yaml_data
.df2 %>% spread(variable, data) %>% as.list(all.names = F) -> test
test[[1]]
test[[2]]
test[[3]]
test[[4]]
test[[4]][[2]]
test[[4]][[1]]
.df2
.df2$data
.df2$data -> test
test[[1]]
test[[2]]
test
yaml_data[[25]]
.df2$data[[25]]
.df2$variable
.df2
.df2 %>% filter(variable == "Land Cover|Cropland|Cereals") %>% pull(data)
.df %>% #dplyr::slice(1) %>%
select(variable, description, unit) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck() ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2$data[[25]]
test[[2]]
.df2$data[[25]]
.df %>% dplyr::slice(1) %>%
select(variable, description, unit) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck() ) )) -> .df2
.df2
names(.df2$data) <- .df2$variable
.df2
.df2$data
.df %>% dplyr::slice(1) %>%
select(variable, description, unit) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2$data
.df
lapply(1:2, function(x){
.df %>% dplyr::slice(x) %>%
select(variable, description, unit) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
}
)
.df2
lapply(1:2, function(x){
.df %>% dplyr::slice(x) %>%
select(variable, description, unit) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2$data
}
)
lapply(1:nrow(.df), function(x){
.df %>% dplyr::slice(x) %>%
select(variable, description, unit) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2$data
}
)
DF_To_yamlList <- function(){
lapply(1:nrow(.df), function(x){
.df %>% dplyr::slice(x) %>%
select(variable, description, unit) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2$data
}
)
}
A
DF_To_yamlList <- function(){
lapply(1:nrow(.df), function(x){
.df %>% dplyr::slice(x) %>%
select(variable, description, unit, tier) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2$data
}
)
}
A %>% mutate(tier = 1) %>%
DF_To_yamlList
DF_To_yamlList <- function(.df){
lapply(1:nrow(.df), function(x){
.df %>% dplyr::slice(x) %>%
select(variable, description, unit, tier) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2$data
}
)
}
A %>% mutate(tier = 1) %>%
DF_To_yamlList
A %>% mutate(tier = 1) %>%
DF_To_yamlList %>%
write_yaml("temp/test.yaml")
A %>% mutate(tier = 1) %>%
DF_To_yamlList
A %>% mutate(tier = "1") %>%
DF_To_yamlList %>%
write_yaml("temp/test.yaml")
A %>% mutate(tier = as.integer(1)) %>%
DF_To_yamlList %>%
write_yaml("temp/test.yaml")
DF_To_yamlList <- function(.df){
assertthat::assert_that(c("variable", "description", "unit", "tier") %in% names(.df) )
lapply(1:nrow(.df), function(x){
.df %>% dplyr::slice(x) %>%
select(variable, description, unit, tier) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2$data
}
)
}
A %>% mutate(tier = as.integer(1)) %>%
DF_To_yamlList %>%
write_yaml("temp/test.yaml")
assertthat::assert_that(all(c("variable", "description", "unit", "tier") %in% names(.df) ))
#assert columns in df include key ones
assertthat::assert_that(is.data.frame(.df))
assertthat::assert_that(is.integer(.df$tier), "Column is not of integer type.")
A %>% mutate(tier = as.integer(1))-> .df
A %>% mutate(tier = as.integer(1))-> .df
assertthat::assert_that(is.integer(.df$tier), "Column is not of integer type; please convert it.")
is.integer(.df$tier)
assertthat::assert_that(is.integer(.df$tier), msg = "Column is not of integer type; please convert it.")
DF_To_yamlList <- function(.df){
#assert columns in df include key ones
assertthat::assert_that(is.data.frame(.df))
assertthat::assert_that(all(c("variable", "description", "unit", "tier") %in% names(.df)))
assertthat::assert_that(is.integer(.df$tier), msg = "Column is not of integer type; please convert it.")
lapply(1:nrow(.df), function(x){
.df %>% dplyr::slice(x) %>%
select(variable, description, unit, tier) %>%
group_by(variable) %>%
nest() %>% ungroup() %>%
mutate(data = list(variable = as.list(data %>% pluck(1) ) )) -> .df2
names(.df2$data) <- .df2$variable
.df2$data
}
)
}
A %>% mutate(tier = as.integer(1)) %>%
DF_To_yamlList %>%
yaml::write_yaml("temp/test.yaml")
.df
